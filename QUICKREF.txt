Bad Apple â†’ Shadertoy Neural Network Compression
================================================

PIPELINE RAPIDE
---------------

1. ./quickstart.sh                                    # Lance tout automatiquement
   OU manuellement:
   
2. python3 bad_apple/train_nn.py                     # EntraÃ®ne NN (1-2h CPU)
3. python3 generate_shadertoy_multipass.py \         # GÃ©nÃ¨re shaders GLSL
     bad_apple/nn_weights_tiny.npz
4. Copier sur Shadertoy.com                          # Voir SHADERTOY_SETUP.md


ARCHITECTURE
------------

VidÃ©o Source                    Neural Network                  Shadertoy Output
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

Bad Apple                       Tiny NN                         Multi-Pass Shader
480Ã—360 px          â”€â”€â”€â”€â”€â”€â†’     [3â†’32â†’64â†’32â†’1]     â”€â”€â”€â”€â”€â”€â†’     Buffer A + Image
6572 frames                     4,353 params                    ~15K chars GLSL
1.08 GB                         17 KB                           Temps rÃ©el 30fps

                    Training                        Code Gen
                    â”€â”€â”€â”€â”€â”€â”€â”€                        â”€â”€â”€â”€â”€â”€â”€â”€
                    â€¢ 5% sample                     â€¢ Weights â†’ GLSL array
                    â€¢ 30 epochs                     â€¢ Buffer A: storage
                    â€¢ MSE loss                      â€¢ Image: NN inference
                    â€¢ Adam opt


FICHIERS CLÃ‰S
-------------

INPUT                           GÃ‰NÃ‰RATION                       OUTPUT
â”€â”€â”€â”€â”€                           â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                       â”€â”€â”€â”€â”€â”€

bad_apple/
  video.webm                    train_nn.py            â”€â†’        nn_weights_tiny.npz
  video_pixels.parquet          (1-2h training)                  nn_weights_tiny.json
                                                                 nn_weights_tiny_metadata.json

nn_weights_tiny.npz             generate_shadertoy     â”€â†’        shadertoy_buffer_a.glsl
                                _multipass.py                    shadertoy_image.glsl
                                (instant)                        SHADERTOY_SETUP.md


UTILISATION SHADERTOY
---------------------

1. CrÃ©er shader:   https://www.shadertoy.com/new
2. Ajouter "Buf A":  Copier shadertoy_buffer_a.glsl
3. Image:          
   - iChannel0 â†’ "Buf A"
   - Copier shadertoy_image.glsl
4. Compiler:       Alt+Enter
5. Play!           ğŸ


QUALITÃ‰ ATTENDUE
----------------

âœ“ Compression:     60,000Ã— (1.08 GB â†’ 17 KB)
âš  QualitÃ© visuelle: â­â­ Acceptable mais floue
âœ“ Reconnaissance:  Oui, silhouettes visibles
âš  Performance:     Lent (calcul per-pixel)
âœ“ Code size:       ~15K chars (bien sous limite 65K)


COMMANDES UTILES
----------------

# Lancer tout
./quickstart.sh

# Juste entraÃ®ner
python3 bad_apple/train_nn.py

# Juste gÃ©nÃ©rer shader
python3 generate_shadertoy_multipass.py bad_apple/nn_weights_tiny.npz

# Analyser la vidÃ©o
python3 bad_apple/analyze_video.py

# Explorer avec notebook
marimo edit main.py


DÃ‰PENDANCES
-----------

torch       - EntraÃ®nement NN
polars      - Data processing
opencv      - Video I/O
numpy       - Calculs
scipy       - DCT (legacy)
pillow      - Images (legacy)


STATS
-----

Video:         480Ã—360 Ã— 6572 frames = 1,135,641,600 pixels
Training:      5% sample = 56,782,080 pixels
Batches:       56,782,080 / 8192 = 6,930 batches/epoch
Total steps:   6,930 Ã— 30 epochs = 207,900 gradient updates
Parameters:    4,353
Code size:     ~15,000 chars GLSL


TROUBLESHOOTING
---------------

EntraÃ®nement lent?   â†’ RÃ©duire epochs/sample_rate OU utiliser GPU
Shader ne compile?   â†’ VÃ©rifier Buffer A connectÃ© Ã  iChannel0
VidÃ©o noire?         â†’ Recompiler, vÃ©rifier connexions buffers
QualitÃ© basse?       â†’ Normal! NN trop petit, augmenter si besoin
Shadertoy lent?      â†’ Normal! 172K forward passes par frame


DOCUMENTATION
-------------

README.md                - Guide complet
SHADERTOY_SETUP.md       - Instructions upload (auto-gÃ©nÃ©rÃ©)
README_PROJET.md         - Doc technique complÃ¨te (legacy DCT)